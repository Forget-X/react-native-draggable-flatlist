{"version":3,"names":["React","ScrollView","Animated","runOnJS","useAnimatedScrollHandler","NestableScrollContainerProvider","useSafeNestableScrollContainerContext","useStableCallback","AnimatedScrollView","createAnimatedComponent","NestableScrollContainerInner","props","outerScrollOffset","containerSize","scrollViewSize","scrollableRef","outerScrollEnabled","onScroll","scrollOffset","onScrollOffsetChange","scrollHandler","event","value","contentOffset","y","onLayout","nativeEvent","layout","height","onContentSizeChange","w","h","NestableScrollContainer","forwardRef","forwardedRef","undefined"],"sources":["NestableScrollContainer.tsx"],"sourcesContent":["import React from \"react\";\n\nimport { LayoutChangeEvent, ScrollViewProps } from \"react-native\";\nimport { ScrollView } from \"react-native-gesture-handler\";\nimport Animated, {\n  runOnJS,\n  useAnimatedScrollHandler,\n} from \"react-native-reanimated\";\n\nimport {\n  NestableScrollContainerProvider,\n  useSafeNestableScrollContainerContext,\n} from \"../context/nestableScrollContainerContext\";\nimport { useStableCallback } from \"../hooks/useStableCallback\";\n\nconst AnimatedScrollView = Animated.createAnimatedComponent(ScrollView);\n\ntype NestableScrollContainerInnerProps = {\n  onScrollOffsetChange?: (scrollOffset: number) => void;\n} & ScrollViewProps;\n\nfunction NestableScrollContainerInner(\n  props: NestableScrollContainerInnerProps\n) {\n  const {\n    outerScrollOffset,\n    containerSize,\n    scrollViewSize,\n    scrollableRef,\n    outerScrollEnabled,\n  } = useSafeNestableScrollContainerContext();\n\n  const onScroll = useStableCallback((scrollOffset: number) => {\n    props.onScrollOffsetChange?.(scrollOffset);\n  });\n\n  const scrollHandler = useAnimatedScrollHandler({\n    onScroll: (event) => {\n      outerScrollOffset.value = event.contentOffset.y;\n      runOnJS(onScroll)(event.contentOffset.y);\n    },\n  });\n\n  const onLayout = useStableCallback((event: LayoutChangeEvent) => {\n    const {\n      nativeEvent: { layout },\n    } = event;\n    containerSize.value = layout.height;\n  });\n\n  const onContentSizeChange = useStableCallback((w: number, h: number) => {\n    scrollViewSize.value = h;\n    props.onContentSizeChange?.(w, h);\n  });\n\n  return (\n    <AnimatedScrollView\n      {...props}\n      onLayout={onLayout}\n      onContentSizeChange={onContentSizeChange}\n      scrollEnabled={outerScrollEnabled}\n      ref={scrollableRef}\n      scrollEventThrottle={1}\n      onScroll={scrollHandler}\n    />\n  );\n}\n\nexport const NestableScrollContainer = React.forwardRef(\n  (\n    props: NestableScrollContainerInnerProps,\n    forwardedRef?: React.ForwardedRef<ScrollView>\n  ) => {\n    return (\n      <NestableScrollContainerProvider\n        forwardedRef={\n          (forwardedRef as React.MutableRefObject<ScrollView>) || undefined\n        }\n      >\n        <NestableScrollContainerInner {...props} />\n      </NestableScrollContainerProvider>\n    );\n  }\n);\n"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAGA,SAASC,UAAT,QAA2B,8BAA3B;AACA,OAAOC,QAAP,IACEC,OADF,EAEEC,wBAFF,QAGO,yBAHP;AAKA,SACEC,+BADF,EAEEC,qCAFF,QAGO,2CAHP;AAIA,SAASC,iBAAT,QAAkC,4BAAlC;AAEA,MAAMC,kBAAkB,GAAGN,QAAQ,CAACO,uBAAT,CAAiCR,UAAjC,CAA3B;;AAMA,SAASS,4BAAT,CACEC,KADF,EAEE;EACA,MAAM;IACJC,iBADI;IAEJC,aAFI;IAGJC,cAHI;IAIJC,aAJI;IAKJC;EALI,IAMFV,qCAAqC,EANzC;EAQA,MAAMW,QAAQ,GAAGV,iBAAiB,CAAEW,YAAD,IAA0B;IAAA;;IAC3D,yBAAAP,KAAK,CAACQ,oBAAN,qFAAAR,KAAK,EAAwBO,YAAxB,CAAL;EACD,CAFiC,CAAlC;EAIA,MAAME,aAAa,GAAGhB,wBAAwB,CAAC;IAC7Ca,QAAQ,EAAGI,KAAD,IAAW;MACnBT,iBAAiB,CAACU,KAAlB,GAA0BD,KAAK,CAACE,aAAN,CAAoBC,CAA9C;MACArB,OAAO,CAACc,QAAD,CAAP,CAAkBI,KAAK,CAACE,aAAN,CAAoBC,CAAtC;IACD;EAJ4C,CAAD,CAA9C;EAOA,MAAMC,QAAQ,GAAGlB,iBAAiB,CAAEc,KAAD,IAA8B;IAC/D,MAAM;MACJK,WAAW,EAAE;QAAEC;MAAF;IADT,IAEFN,KAFJ;IAGAR,aAAa,CAACS,KAAd,GAAsBK,MAAM,CAACC,MAA7B;EACD,CALiC,CAAlC;EAOA,MAAMC,mBAAmB,GAAGtB,iBAAiB,CAAC,CAACuB,CAAD,EAAYC,CAAZ,KAA0B;IAAA;;IACtEjB,cAAc,CAACQ,KAAf,GAAuBS,CAAvB;IACA,yBAAApB,KAAK,CAACkB,mBAAN,qFAAAlB,KAAK,EAAuBmB,CAAvB,EAA0BC,CAA1B,CAAL;EACD,CAH4C,CAA7C;EAKA,oBACE,oBAAC,kBAAD,eACMpB,KADN;IAEE,QAAQ,EAAEc,QAFZ;IAGE,mBAAmB,EAAEI,mBAHvB;IAIE,aAAa,EAAEb,kBAJjB;IAKE,GAAG,EAAED,aALP;IAME,mBAAmB,EAAE,CANvB;IAOE,QAAQ,EAAEK;EAPZ,GADF;AAWD;;AAED,OAAO,MAAMY,uBAAuB,gBAAGhC,KAAK,CAACiC,UAAN,CACrC,CACEtB,KADF,EAEEuB,YAFF,KAGK;EACH,oBACE,oBAAC,+BAAD;IACE,YAAY,EACTA,YAAD,IAAwDC;EAF5D,gBAKE,oBAAC,4BAAD,EAAkCxB,KAAlC,CALF,CADF;AASD,CAdoC,CAAhC"}