{"version":3,"names":["AnimatedScrollView","Animated","createAnimatedComponent","ScrollView","NestableScrollContainerInner","props","useSafeNestableScrollContainerContext","outerScrollOffset","containerSize","scrollViewSize","scrollableRef","outerScrollEnabled","onScroll","useStableCallback","scrollOffset","onScrollOffsetChange","scrollHandler","useAnimatedScrollHandler","event","value","contentOffset","y","runOnJS","onLayout","layout","nativeEvent","height","onContentSizeChange","w","h","NestableScrollContainer","React","forwardRef","forwardedRef","undefined"],"sources":["NestableScrollContainer.tsx"],"sourcesContent":["import React from \"react\";\n\nimport { LayoutChangeEvent, ScrollViewProps } from \"react-native\";\nimport { ScrollView } from \"react-native-gesture-handler\";\nimport Animated, {\n  runOnJS,\n  useAnimatedScrollHandler,\n} from \"react-native-reanimated\";\n\nimport {\n  NestableScrollContainerProvider,\n  useSafeNestableScrollContainerContext,\n} from \"../context/nestableScrollContainerContext\";\nimport { useStableCallback } from \"../hooks/useStableCallback\";\n\nconst AnimatedScrollView = Animated.createAnimatedComponent(ScrollView);\n\ntype NestableScrollContainerInnerProps = {\n  onScrollOffsetChange?: (scrollOffset: number) => void;\n} & ScrollViewProps;\n\nfunction NestableScrollContainerInner(\n  props: NestableScrollContainerInnerProps\n) {\n  const {\n    outerScrollOffset,\n    containerSize,\n    scrollViewSize,\n    scrollableRef,\n    outerScrollEnabled,\n  } = useSafeNestableScrollContainerContext();\n\n  const onScroll = useStableCallback((scrollOffset: number) => {\n    props.onScrollOffsetChange?.(scrollOffset);\n  });\n\n  const scrollHandler = useAnimatedScrollHandler({\n    onScroll: (event) => {\n      outerScrollOffset.value = event.contentOffset.y;\n      runOnJS(onScroll)(event.contentOffset.y);\n    },\n  });\n\n  const onLayout = useStableCallback((event: LayoutChangeEvent) => {\n    const {\n      nativeEvent: { layout },\n    } = event;\n    containerSize.value = layout.height;\n  });\n\n  const onContentSizeChange = useStableCallback((w: number, h: number) => {\n    scrollViewSize.value = h;\n    props.onContentSizeChange?.(w, h);\n  });\n\n  return (\n    <AnimatedScrollView\n      {...props}\n      onLayout={onLayout}\n      onContentSizeChange={onContentSizeChange}\n      scrollEnabled={outerScrollEnabled}\n      ref={scrollableRef}\n      scrollEventThrottle={1}\n      onScroll={scrollHandler}\n    />\n  );\n}\n\nexport const NestableScrollContainer = React.forwardRef(\n  (\n    props: NestableScrollContainerInnerProps,\n    forwardedRef?: React.ForwardedRef<ScrollView>\n  ) => {\n    return (\n      <NestableScrollContainerProvider\n        forwardedRef={\n          (forwardedRef as React.MutableRefObject<ScrollView>) || undefined\n        }\n      >\n        <NestableScrollContainerInner {...props} />\n      </NestableScrollContainerProvider>\n    );\n  }\n);\n"],"mappings":"mQAAA,oDAGA,uEACA,uFAKA,yFAIA,6D,goCAEA,GAAMA,mBAAkB,CAAGC,8BAAA,CAASC,uBAAT,CAAiCC,qCAAjC,CAA3B,CAMA,QAASC,6BAAT,CACEC,KADF,CAEE,2BAOI,GAAAC,qEAAA,GAPJ,CAEEC,iBAFF,uBAEEA,iBAFF,CAGEC,aAHF,uBAGEA,aAHF,CAIEC,cAJF,uBAIEA,cAJF,CAKEC,aALF,uBAKEA,aALF,CAMEC,kBANF,uBAMEA,kBANF,CASA,GAAMC,SAAQ,CAAG,GAAAC,oCAAA,EAAkB,SAACC,YAAD,CAA0B,CAC3DT,KAAK,CAACU,oBAAN,cAAAV,KAAK,CAACU,oBAAN,CAA6BD,YAA7B,EACD,CAFgB,CAAjB,CAIA,GAAME,cAAa,CAAG,GAAAC,+CAAA,EAAyB,CAC7CL,QAAQ,+BAAGM,KAAH,CAAa,CACnBX,iBAAiB,CAACY,KAAlB,CAA0BD,KAAK,CAACE,aAAN,CAAoBC,CAA9C,CACA,GAAAC,8BAAA,EAAQV,QAAR,EAAkBM,KAAK,CAACE,aAAN,CAAoBC,CAAtC,EACD,CAHO,gCAnCVd,iBAmCU,SAlCVe,8BAkCU,UAlCFV,QAkCE,qWADqC,CAAzB,CAAtB,CAOA,GAAMW,SAAQ,CAAG,GAAAV,oCAAA,EAAkB,SAACK,KAAD,CAA8B,IAE9CM,OAF8C,CAG3DN,KAH2D,CAE7DO,WAF6D,CAE9CD,MAF8C,CAI/DhB,aAAa,CAACW,KAAd,CAAsBK,MAAM,CAACE,MAA7B,CACD,CALgB,CAAjB,CAOA,GAAMC,oBAAmB,CAAG,GAAAd,oCAAA,EAAkB,SAACe,CAAD,CAAYC,CAAZ,CAA0B,CACtEpB,cAAc,CAACU,KAAf,CAAuBU,CAAvB,CACAxB,KAAK,CAACsB,mBAAN,cAAAtB,KAAK,CAACsB,mBAAN,CAA4BC,CAA5B,CAA+BC,CAA/B,EACD,CAH2B,CAA5B,CAKA,MACE,8BAAC,kBAAD,0BACMxB,KADN,EAEE,QAAQ,CAAEkB,QAFZ,CAGE,mBAAmB,CAAEI,mBAHvB,CAIE,aAAa,CAAEhB,kBAJjB,CAKE,GAAG,CAAED,aALP,CAME,mBAAmB,CAAE,CANvB,CAOE,QAAQ,CAAEM,aAPZ,6EADF,CAWD,CAEM,GAAMc,wBAAuB,CAAGC,cAAA,CAAMC,UAAN,CACrC,SACE3B,KADF,CAEE4B,YAFF,CAGK,CACH,MACE,8BAAC,+DAAD,EACE,YAAY,CACTA,YAAD,EAAwDC,SAF5D,6EAKE,6BAAC,4BAAD,0BAAkC7B,KAAlC,+EALF,CADF,CASD,CAdoC,CAAhC,C"}